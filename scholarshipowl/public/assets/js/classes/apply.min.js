var ApplyTable=Element.extend({_init:function(a){this._super(a);var e=this,s="/api/v1.0/apply",t="get",o="json",r=$("input[name=_token]").val();if("undefined"==typeof r)throw"Token Not Defined";var n=new Ajax(s,t,o);n.onBeforeSend=function(a){},n.onError=function(a,e,s){},n.onSuccess=function(s){if("ok"==s.status){if($.isEmptyObject(s.data.scholarships));else{var t=$("input[name=paid_account]").val();for(var o in s.data.scholarships){var r="",n=0;if($.isEmptyObject(s.data.scholarships[o].essays))r+="No essay required";else{var i=s.data.scholarships[o].essays;if(e.objSize(i)>1){var l=0,p=0;for(var c in i)i[c].min_words>0?i[c].max_words>0?l+=parseInt(i[c].max_words):1==i[c].min_words||(l+=parseInt(i[c].min_words)):i[c].max_words>0?l+=parseInt(i[c].max_words):i[c].min_characters>0?i[c].max_characters>0?p+=parseInt(i[c].max_characters):1==i[c].min_characters||(p+=parseInt(i[c].min_characters)):i[c].max_characters>0&&(p+=parseInt(i[c].max_characters));l>0?(r+=l+" words ",r+="("+e.objSize(i)+" essays*)",n=6e6+100*parseInt(l)):p>0?(r+=p+" characters ",r+="("+e.objSize(i)+" essays*)",n=3e6+100*parseInt(p)):(r+=e.objSize(i)+" essays required**",n=2)}else for(var c in i)i[c].min_words>0?i[c].max_words>0?(r+=i[c].min_words+" to "+i[c].max_words+" words",n=6000002+parseInt(100*i[c].max_words)+parseInt(i[c].min_words)):1==i[c].min_words?(r+="Essay required **",n=1):(r+="Minimum "+i[c].min_words+" words",n=6000001+parseInt(100*i[c].min_words)+parseInt(i[c].min_words)):i[c].max_words>0?(r+="Up to "+i[c].max_words+" words",n=6e6+parseInt(100*i[c].max_words)):i[c].min_characters>0?i[c].max_characters>0?(r+=i[c].min_characters+" to "+i[c].max_characters+" characters",n=3000002+parseInt(100*i[c].max_characters)+parseInt(i[c].min_characters)):1==i[c].min_characters?(r+="Essay required **",n=1):(r+="Minimum "+i[c].min_characters+" characters",n=3000001+parseInt(100*i[c].min_characters)+parseInt(i[c].min_characters)):i[c].max_characters>0&&(r+="Up to "+i[c].max_characters+" characters",n=3e6+parseInt(100*i[c].max_characters))}var d='<tr id="row'+s.data.scholarships[o].scholarship_id+'" class="clickable">';d+="0"==t?'<td data-text="'+n+'" class="mod-td-checkbox"><input name="scholarship_id[]" type="hidden" value="'+s.data.scholarships[o].scholarship_id+'"><input class="ApplyCheckbox" name="apply[]" type="checkbox" value="'+s.data.scholarships[o].scholarship_id+'"><span class="lbl padding-0"></span></td>':'<td data-text="1" class="mod-td-checkbox"><input name="scholarship_id[]" type="hidden" value="'+s.data.scholarships[o].scholarship_id+'"><input class="ApplyCheckbox" name="apply[]" type="checkbox" value="'+s.data.scholarships[o].scholarship_id+'"><span class="lbl padding-0"></span></td>',d+="0"==t?"<td><strong>"+s.data.scholarships[o].title+"</strong></td>":'<td class="mod-td-title"><strong class="text-semibold"><a href="#" class="toggle">'+s.data.scholarships[o].title+'</a></strong><small class="visible-xs visible-sm text-blue">Deadline '+s.data.scholarships[o].expiration_date+"</small></td>",d+='<td class="mod-td-toc"><a href="'+(""!=s.data.scholarships[o].terms_of_service_url?s.data.scholarships[o].terms_of_service_url:s.data.scholarships[o].url)+'" target="_blank" class="text-black">View T&C</a></td>',"1"==t&&(d+='<td class="mod-td-essay" data-text="'+n+'">',d+=r,d+="</td>");var h=s.data.scholarships[o].expiration_date.split("/"),m=h[2]+h[0]+h[1];if(d+='<td class="hidden-xs hidden-sm mod-td-deadline" data-text="'+m+'">'+s.data.scholarships[o].expiration_date+"</td>",d+='<td class="mod-td-ammount"><strong>$'+s.data.scholarships[o].amount+"</strong></td>",d+="</tr>",d+='<tr class="tablesorter-childRow">',d+="<td>&nbsp</td>",d+='<td class="expanded-row"><p><a href="'+s.data.scholarships[o].url+'" target="_blank">'+s.data.scholarships[o].url+"</a>&nbsp;</p><p>"+s.data.scholarships[o].description+"</p></td>",d+="<td>&nbsp</td>",d+='<td class="expanded-row" colspan="3">',!$.isEmptyObject(s.data.scholarships[o].essays)){var i=s.data.scholarships[o].essays;if(e.objSize(i)>1)for(var c in i)d+="<h4>Essay: "+i[c].title+"</h4>",d+="<p>"+i[c].description+"</p>";else for(var c in i)d+="<h4>Essay: "+i[c].title+"</h4>",d+="<p>"+i[c].description+"</p>"}d+="</td>",d+="</tr>",a.find("tbody").append(d)}"1"==t?(a.tablesorter({sortList:[[0,0]]}),$("th[data-field=essay_required]").removeClass("hidden")):(a.tablesorter({sortList:[[3,0]]}),$("th[data-field=essay_required]").remove()),a.trigger("update"),e.preselect(),$("#default-sort").addClass("tablesorter-headerAsc")}$(".scroll-magic").addClass("section--continue--fixed fadeInUp")}else if("error"==s.status)switch(s.data){case-1:alert("System error");break;case 1e3:alert("Apply not selected");break;case 1001:alert("Apply payed members only");break;case 1002:alert("Apply no credit")}else"redirect"==s.status&&(window.location=s.message)},n.sendRequest()},objSize:function(a){var e=0;if("object"==typeof a)if(Object.keys)e=Object.keys(a).length;else if(window._)e=_.keys(a).length;else if(window.$)e=$.map(a,function(){return 1}).length;else for(var s in a)a.hasOwnProperty(s)&&e++;return e},preselect:function(){var a=$("input[name=pretick]").val();a&&("pretick_all"==a?($(".ApplyCheckbox").prop("checked",!0),$("#selectAll").toggleClass("hidden"),$("#selectNone").toggleClass("hidden")):($(".ApplyCheckbox").slice(0,parseInt(a)).prop("checked",!0),$(".ApplyCheckbox").length<=a&&($("#selectAll").toggleClass("hidden"),$("#selectNone").toggleClass("hidden"))))}}),ApplyButton=Class.extend({_init:function(a){var e=this;a.click(function(a){a.preventDefault();var s=e.onBeforeAction.apply(e,arguments);if(0==s)return!1;var t=$("input[name=_token]").val();if("undefined"==typeof t)throw"Token Not Defined";var o="/api/v1.0/apply",r="post",n="json",i=new Object,l=$("input[name='apply[]']:checked").map(function(){return $(this).val()}).get();i.scholarships=l,i=JSON.parse(JSON.stringify(i));var p=new Ajax(o,r,n,i);p.onBeforeSend=function(a){},p.onSuccess=function(a){e.onSuccess.apply(e,arguments)},p.onError=function(a,s,t){e.onError.apply(e,arguments)},p.onComplete=function(){},p.sendRequest()})},onBeforeAction:function(){var a=$.find("input[name='apply[]']:checked").length;return 0==a?($("#Popup .modal-body").html("Please select at least one scholarship to apply to before you proceed."),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' data-dismiss='modal'>Ok</a>"),$("#Popup").modal("show"),!1):!0},onSuccess:function(a){if("ok"==a.status){var e="We have successfully applied you to the selected Scholarships. You will now be redirected to the account page.",s=a.message;$("#Popup .modal-body").html(e),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' href='"+s+"'>Continue</a>"),$("#Popup").modal("show"),setTimeout("window.top.location.href = '"+s+"';",1e4)}else if("redirect"==a.status)if("my-applications"==a.data){var e="Great Job. Answer the essay questions on the next page to complete your applications.",s=a.data;$("#Popup .modal-body").html(e),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' href='"+s+"'>Continue</a>"),$("#Popup").modal("show"),setTimeout("window.top.location.href = '"+s+"';",1e4)}else if(readCookie("do-not-show-apply"))setTimeout("window.top.location.href = '"+s+"';",1e3);else{var e="Great job. Now explore your account and submit your applications from the 'Applications' page.",s=a.data;$("#Popup").addClass("apply-popup"),$("#Popup .modal-body").html(e),$("#Popup .modal-footer").html('<label  class="dns-label"><input name="do-not-show" type="checkbox" value="do-not-show" id="do-not-show"><span class="lbl padding-0"></span>Don\'t show this message again<br /></label><a type=\'button\' class=\'btn btn-warning center-block buttonSelectProceed\' href=\''+s+"'>Continue</a>"),$("#Popup").modal("show").one("click",".buttonSelectProceed",function(){$("#do-not-show").prop("checked")&&createCookie("do-not-show-apply",1,7300)})}else"error"==a.status&&(1002==a.data?new PaymentPopup($("#payment-popup")):($("#Popup .modal-body").html(a.message),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' data-dismiss='modal'>Ok</a>"),$("#Popup").modal("show")))}});
var LoginButton=AjaxButton.extend({onBeforeSend:function(e){$("#LoginErrorEmail").hide(),$("#LoginErrorPassword").hide()},onSuccess:function(e){"redirect"==e.status?window.location=e.data:"error"==e.status&&(e.data.email&&($("#LoginErrorEmail").html(e.data.email),$("#LoginErrorEmail").show()),e.data.password&&($("#LoginErrorPassword").html(e.data.password),$("#LoginErrorPassword").show()))}}),ForgotPasswordButton=AjaxButton.extend({onBeforeSend:function(e){$("#ForgotPasswordErrorEmail").hide()},onSuccess:function(e){"ok"==e.status?$("#forgot-password-form").html(e.message):"error"==e.status&&e.data.email&&($("#ForgotPasswordErrorEmail").html(e.data.email),$("#ForgotPasswordErrorEmail").show())}}),ResetPasswordButton=AjaxButton.extend({onBeforeSend:function(e){$("#ResetPasswordErrorEmail").hide(),$("#ResetPasswordErrorPassword").hide(),$("#ResetPasswordErrorToken").hide()},onSuccess:function(e){if("ok"==e.status){var t=e.data.url;$("#Popup .modal-body").html(e.message),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' href='"+t+"'>Continue</a>"),$("#Popup").modal("show")}else"error"==e.status&&(e.data.email&&($("#ResetPasswordErrorEmail").html(e.data.email),$("#ResetPasswordErrorEmail").show()),e.data.password&&($("#ResetPasswordErrorPassword").html(e.data.password),$("#ResetPasswordErrorPassword").show()),e.data.token&&($("#ResetPasswordErrorToken").html(e.data.token),$("#ResetPasswordErrorToken").show()))}}),SaveProfile=AjaxButton.extend({_init:function(e){this._super(e)},onBeforeSend:function(e){$(".help-block").hide()},onSuccess:function(e){if("ok"==e.status){var t=e.data.apply_url;$("#Popup .modal-body").html(e.message),$("#Popup .modal-footer").html("<a type='button' class='btn btn-warning btn-block text-uppercase text-center' href='"+t+"'>Apply Now</a><a type='button' class='btn btn-primary btn-block text-center' data-dismiss='modal'>Continue completing profile</a>"),$("#Popup").modal("show")}else"error"==e.status&&$.each(e.data,function(e,t){$(".help-block[data-error="+e+"]").html(t),$(".help-block[data-error="+e+"]").show()})}}),ContactButton=AjaxButton.extend({onBeforeSend:function(e){$("#content").removeClass("error"),$("input[name=name]").removeClass("error"),$("input[name=email]").removeClass("error")},onSuccess:function(e){if("ok"==e.status){var t="<p class='success' style='margin: 10px;'>Your mail was successfully sent</p>";$("#contact-form").html(t).attr("style","font-size: 18px; text-align: center;")}else"error"==e.status&&$.each(e.data,function(e,t){$("#"+e).addClass("error"),$("input[name="+e+"]").addClass("error")})}}),MailboxButton=Class.extend({_init:function(e){var t=this;e.click(function(e){e.preventDefault();var a=$(t).attr("data-message-count");if($.isEmptyObject(a)){var o="Currently, there are no emails in your application inbox to display. Please check back regularly for updates on your scholarships";$("#Popup .modal-body").html(o),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' data-dismiss='modal'>Ok</a>"),$("#Popup").modal("show")}else window.location=$(t).attr("href")})}}),ApplyButton=Class.extend({_init:function(e){var t=this;e.click(function(e){e.preventDefault();var a=t.onBeforeAction.apply(t,arguments);if(0==a)return!1;var o=$("input[name=_token]").val();if("undefined"==typeof o)throw"Token Not Defined";var s="/api/v1.0/apply",n="post",r="json",i=new Object,l=$("input[name='apply[]']:checked").map(function(){return $(this).val()}).get();i.scholarships=l,i=JSON.parse(JSON.stringify(i)),console.log(i);var d=new Ajax(s,n,r,i);d.onBeforeSend=function(e){},d.onSuccess=function(e){t.onSuccess.apply(t,arguments)},d.onError=function(e,a,o){t.onError.apply(t,arguments)},d.onComplete=function(){},d.sendRequest()})},onBeforeAction:function(){var e=$.find("input[name='apply[]']:checked").length;return 0==e?($("#Popup .modal-body").html("Please select at least one scholarship to apply to before you proceed."),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' data-dismiss='modal'>Ok</a>"),$("#Popup").modal("show"),!1):!0},onSuccess:function(e){if("ok"==e.status){var t="We have successfully applied you to the selected Scholarships. You will now be redirected to the account page.",a=e.message;$("#Popup .modal-body").html(t),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' href='"+a+"'>Continue</a>"),$("#Popup").modal("show"),setTimeout("window.top.location.href = '"+a+"';",1e4)}else if("redirect"==e.status)if("my-applications"==e.data){var t="Great Job. Answer the essay questions on the next page to complete your applications.",a=e.data;$("#Popup .modal-body").html(t),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' href='"+a+"'>Continue</a>"),$("#Popup").modal("show"),setTimeout("window.top.location.href = '"+a+"';",1e4)}else window.location=e.message;else if("error"==e.status){if(1002==e.data){var o=$("input[name=credit][type=hidden]").val();$("#Popup .modal-body").html("You can apply to only "+o+" scholarships. Please make your selection accordingly.")}else $("#Popup .modal-body").html(e.message);$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' data-dismiss='modal'>Ok</a>"),$("#Popup").modal("show")}}}),ApplyCheckbox=Element.extend({_init:function(e){this._super(e),e.bind("change",function(t){t.preventDefault();var a=$("input[name=is_free][type=hidden]").val(),o=$("input[name=credit][type=hidden]").val(),s=$.find("input[name='apply[]']:checked").length,n=$(e).is(":checked");s>o&&1==n&&!a&&(o>0?($("#Popup .modal-body").html("You can apply to only "+o+" scholarships. Please make your selection accordingly."),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' data-dismiss='modal'>Ok</a>"),$("#Popup").modal("show")):($("#Popup .modal-body").html("You have used up your available scholarships. To apply for more continue here."),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' href='my-account'>Continue</a>"),$("#Popup").modal("show")))})}}),EssayForm=Element.extend({_init:function(e){this._super(e);var t=!0,a=$("#LeavingModal"),o=!1;a.on("hidden.bs.modal",function(e){o=!1});var s=$("input[name=_token]").val();if("undefined"==typeof s)throw"Token Not Defined";var n=$(this).attr("data-essays-count");0>=n&&($("#Popup .modal-body").html("None of the applications you selected require an essay."),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' href='my-account'>Ok</a>"),$("#Popup").modal("show"));var r=new Element("#EssaySelect");r.bind("change",function(e){e.preventDefault();var n=$(this).val();if(t){if(n){var r=new Ajax("/post-essay","post","json",{essayId:n});r.onBeforeSend=function(e){e.setRequestHeader("X-CSRF-Token",s),$("#EssayText").val(""),$("#EssayDescription").html(""),$("#EssayTextParsed").html(""),$("#EssayRequirements").html(""),$("#EssayRequirementsValues input[type=hidden]").val(""),$("#ScholarshipData").html("")},r.onSuccess=function(e){if("ok"==e.status){var t=e.data;$("#EssayText").val(t.text),$("#EssayDescription").html(t.description),p(t.text),u(t.minWords,t.maxWords,t.minCharacters,t.maxCharacters),c(t.scholarshipTitle,t.scholarshipAmount)}},r.sendRequest()}}else o=!0,a.modal("show").one("click",".LeaveButton",function(){if(isExit=!1,n){var e=new Ajax("/post-essay","post","json",{essayId:n});e.onBeforeSend=function(e){e.setRequestHeader("X-CSRF-Token",s),$("#EssayText").val(""),$("#EssayDescription").html(""),$("#EssayTextParsed").html(""),$("#EssayRequirements").html(""),$("#EssayRequirementsValues input[type=hidden]").val(""),$("#ScholarshipData").html("")},e.onSuccess=function(e){if("ok"==e.status){var o=e.data;$("#EssayText").val(o.text),$("#EssayDescription").html(o.description),a.modal("hide"),t=!0,p(o.text),u(o.minWords,o.maxWords,o.minCharacters,o.maxCharacters),c(o.scholarshipTitle,o.scholarshipAmount)}},e.sendRequest()}})}),"0"==$("#EssaySelect").val()&&$("#EssaySelect option:eq(1)").attr("selected","selected"),$("#EssaySelect").change();var i=new Element("#EssayText");i.bind("input propertychange",function(e){e.preventDefault(),p($(this).val())});var l=$("#EssayText").val();i.bind("propertychange change click keyup input paste",function(e){l!=$(this).val()&&""!=$(this).val()&&t&&(l=$(this).val(),t=!1)});new Element(".EssaySaveButton");$(".EssaySaveButton").bind("click",function(e){if(e.preventDefault(),!$(this).hasClass("NotEditable")){var a=$("input[name=_token]").val();if("undefined"==typeof a)throw"Token Not Defined";var o=$("#EssaySelect").val(),s=$("#EssayText").val();if(o&&s){var n=new Ajax("/post-save-essay","post","json",{essayId:o,text:s});n.onBeforeSend=function(e){e.setRequestHeader("X-CSRF-Token",a)},n.onSuccess=function(e){$("#EssaysSaved").html(e.data.saved),$("#EssaysSavedAmount").html(e.data.savedAmount),t=!0,l=$("#EssayText").val(),$("#Popup .modal-body").html(e.message),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' data-dismiss='modal'>Ok</a>"),$("#Popup").modal("show")},n.sendRequest()}}});var d=new Element(".EssaysDone");d.bind("click",function(e){e.preventDefault(),t?window.location=$(this).attr("href"):a.modal("show").one("click",".LeaveButton",function(){isExit=!1,o||(window.location=$(this).attr("href"))})});var p=function(e){var t=m(e),a=h(e);t?$(".EssaySaveButton").removeAttr("disabled").removeClass("NotEditable"):$(".EssaySaveButton").attr("disabled","disabled").addClass("NotEditable"),a&&$("#EssayTextParsed").html("Words: "+a.words+" | Characters: "+a.characters)},u=function(e,t,a,o){e>0&&($("#EssayRequirements").append("Minimum Words: "+e+"<br>"),$("input[type=hidden][name=EssayMinWords]").val(e)),t>0&&($("#EssayRequirements").append("Maximum Words: "+t+"<br>"),$("input[type=hidden][name=EssayMaxWords]").val(t)),a>0&&($("#EssayRequirements").append("Minimum Characters: "+a+"<br>"),$("input[type=hidden][name=EssayMinCharacters]").val(a)),o>0&&($("#EssayRequirements").append("Maximum Characters: "+o+"<br>"),$("input[type=hidden][name=EssayMaxCharacters]").val(o))},c=function(e,t){$("#ScholarshipData").html("This essay is for "+e+" worth <span class='number'>$"+t+"</span>"),$.fn.digits=function(){return this.each(function(){$(this).text($(this).text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"))})},$("span.number").digits()},m=function(e){if(!e)return!1;var t=!0,a=h(e),o=$("input[type=hidden][name=EssayMinWords]").val(),s=$("input[type=hidden][name=EssayMaxWords]").val(),n=$("input[type=hidden][name=EssayMinCharacters]").val(),r=$("input[type=hidden][name=EssayMaxCharacters]").val();return o&&a.words<o&&(t=!1),s&&a.words>s&&(t=!1),n&&a.characters<n&&(t=!1),r&&a.characters>r&&(t=!1),t},h=function(e){var t={words:0,characters:0};return 0==e.length?t:($temp=e.replace(/(^\s*)|(\s*$)/gi,""),$temp=$temp.replace(/[ ]{2,}/gi," "),$temp=$temp.replace(/\n /,"\n"),t.words=$temp.split(" ").length,t.characters=$temp.length,t)}}}),NoEssaysButton=Element.extend({_init:function(e){this._super(e),e.bind("click",function(e){e.preventDefault();var t=$(this).attr("data-essays-count");t>0?($(this).attr("href","essays"),window.location="essays"):($("#Popup .modal-body").html("None of the applications you selected require an essay."),$("#Popup .modal-footer").html("<a type='button' class='btn btn-primary center-block' data-dismiss='modal'>Ok</a>"),$("#Popup").modal("show"))})}});